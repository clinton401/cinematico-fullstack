import{r as l,m as S,n as C,o as F,j as e,F as L,p as D,q as P,s as h}from"./index-PY5ovYXI.js";function I(){const[n,w]=l.useState(!1),[g,c]=l.useState(!1),[j,d]=l.useState({email:"",password:""}),[b,o]=l.useState({emailErr:null,passwordErr:null}),{toastHandler:u,isRouteValid:R,isLoggedIn:E,authUrl:y}=l.useContext(S),N=C(),r=F(),{emailErr:m,passwordErr:f}=b,{email:p,password:i}=j;function x(a,s){a&&s!==void 0&&d(t=>({...t,[a]:s}))}l.useEffect(()=>{E&&N("/")},[]);async function v(a){a.preventDefault();try{c(!0);const s=await fetch(`${y}/auth/login`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:p,password:i,verifiedRedirects:r})});if(s.ok){const t=await s.json();o({emailErr:null,passwordErr:null,usernameErr:null}),d({email:"",password:""}),window.location.href=t.redirectUrl,u(!0,t.msg||"Login successful")}else{const{error:t}=await s.json();if(typeof t.msg=="object")o({emailErr:t.msg.email,passwordErr:t.msg.password});else throw o({emailErr:null,passwordErr:null}),new Error(t.msg||"Something went wrong. Please try again later.")}}catch(s){console.error(s),u(!1,s.message||s.msg||"Something went wrong. Please try again later.")}finally{c(!1)}}return e.jsx("main",{className:"w-full flex flex-col  gap-8 items-center justify-center px-5half min-h-dvh pb-10 pt-[150px] ",children:e.jsxs("form",{onSubmit:v,className:"w-full max-w-[400px] shadow-lg text-white bg-black  rounded-md flex flex-col gap-6 p-4",children:[e.jsx("h2",{className:"font-cinzel font-black flex  items-center pb-2 text-2xl",children:"Login"}),e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("input",{type:"text",required:!0,name:"email",onChange:({target:a})=>x("email",a.value),value:p,className:"w-full outline-none  bg-transparent border-b  placeholder:text-base text-white placeholder:italic  placeholder:font-cinzel  font-medium text-lg ",placeholder:"Email address"}),m&&e.jsx("span",{className:"text-xs text-red-700",children:m})]}),e.jsxs("div",{className:"w-full flex flex-col gap-2  mb-2",children:[e.jsxs("span",{className:"w-full relative",children:[e.jsx("input",{onChange:({target:a})=>x("password",a.value),name:"password",type:n?"text":"password",className:"w-full outline-none  bg-transparent border-b  pr-[35px] placeholder:text-base text-white placeholder:italic  placeholder:font-cinzel  font-medium text-lg ",placeholder:"Password",required:!0,value:i}),i.length>0&&e.jsx(L,{icon:n?P:D,className:"w-[20px] aspect-square cursor-pointer flex items-center justify-center absolute right-0 top-2/4  translate-y-[-50%]",onClick:()=>{w(!n)}})]}),f&&e.jsx("span",{className:"text-xs text-red-700",children:f})]}),e.jsxs(h,{to:`/forgot-password${r?`?redirects=${encodeURIComponent(r)}`:""}`,className:" text-[#FFD700] text-sm w-full text-right outline-none hover:underline focus:underline",children:["Forgot password"," "]}),e.jsxs("button",{className:"w-full button flex items-center justify-center",children:["Login"," ",g&&e.jsx("div",{className:"loader ml-1",id:"loader"})]}),e.jsxs("p",{className:"w-full text-center flex-wrap flex  text-xs items-center justify-center ",children:["Don't have an account?"," ",e.jsxs(h,{to:`/signup${r?`?redirects=${encodeURIComponent(r)}`:""}`,className:"pl-2 text-[#FFD700]  outline-none hover:underline focus:underline",children:["Sign up"," "]})," "]})]})})}export{I as default};
