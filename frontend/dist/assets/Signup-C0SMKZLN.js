import{r,m as C,n as P,o as U,j as e,F as k,p as q,q as D,s as F}from"./index-PY5ovYXI.js";function z(){const[l,j]=r.useState(!1),[b,u]=r.useState(!1),[E,d]=r.useState({email:"",username:"",password:""}),[y,n]=r.useState({emailErr:null,passwordErr:null,usernameErr:null}),{toastHandler:m,isLoggedIn:N,authUrl:v}=r.useContext(C),{emailErr:x,passwordErr:p,usernameErr:f}=y,{email:h,username:w,password:o}=E,g=P(),i=U();function c(s,a){s&&a!==void 0&&d(t=>({...t,[s]:a}))}r.useEffect(()=>{N&&g("/")},[]);async function S(s){s.preventDefault();try{u(!0);const a=await fetch(`${v}/auth/register`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:h,username:w,password:o,verifiedRedirects:i})});if(a.ok){const t=await a.json();n({emailErr:null,passwordErr:null,usernameErr:null}),d({email:"",username:"",password:""}),g(t.redirectUrl),m(!0,t.msg||"User registered successfully")}else{const{error:t}=await a.json();if(typeof t.msg=="object")n({emailErr:t.msg.email,usernameErr:t.msg.username,passwordErr:t.msg.password});else throw n({emailErr:null,passwordErr:null,usernameErr:null}),new Error(t.msg||"Something went wrong. Please try again later.")}}catch(a){console.error(a),m(!1,a.message||a.msg||"Something went wrong. Please try again later.")}finally{u(!1)}}return e.jsx("main",{className:"w-full flex flex-col gap-8 items-center justify-center px-5half min-h-dvh pb-10 pt-[150px] ",children:e.jsxs("form",{onSubmit:S,className:"w-full max-w-[400px] shadow-lg text-white bg-black  rounded-md flex flex-col gap-6 p-4",children:[e.jsx("h2",{className:"font-cinzel font-black flex  items-center pb-2 text-2xl",children:"Sign Up"}),e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("input",{type:"text",required:!0,name:"username",value:w,onChange:({target:s})=>c("username",s.value),className:"w-full outline-none  bg-transparent border-b  placeholder:text-base text-white placeholder:italic  placeholder:font-cinzel  font-medium text-lg ",placeholder:"Username"}),f&&e.jsx("span",{className:"text-xs text-red-700",children:f})]}),e.jsxs("div",{className:"w-full flex flex-col gap-2",children:[e.jsx("input",{type:"text",required:!0,name:"email",onChange:({target:s})=>c("email",s.value),value:h,className:"w-full outline-none  bg-transparent border-b  placeholder:text-base text-white placeholder:italic  placeholder:font-cinzel  font-medium text-lg ",placeholder:"Email address"}),x&&e.jsx("span",{className:"text-xs text-red-700",children:x})]}),e.jsxs("div",{className:"w-full flex flex-col gap-2  mb-2",children:[e.jsxs("span",{className:"w-full relative",children:[e.jsx("input",{onChange:({target:s})=>c("password",s.value),name:"password",type:l?"text":"password",className:"w-full outline-none  bg-transparent border-b  pr-[35px] placeholder:text-base text-white placeholder:italic  placeholder:font-cinzel  font-medium text-lg ",placeholder:"Password",required:!0,value:o}),o.length>0&&e.jsx(k,{icon:l?D:q,className:"w-[20px] aspect-square cursor-pointer flex items-center justify-center absolute right-0 top-2/4  translate-y-[-50%]",onClick:()=>{j(!l)}})]}),p&&e.jsx("span",{className:"text-xs text-red-700",children:p})]}),e.jsxs("button",{className:"w-full button flex items-center justify-center",children:["Create account ",b&&e.jsx("div",{className:"loader ml-1",id:"loader"})]}),e.jsxs("p",{className:"w-full text-center flex-wrap flex  text-xs items-center justify-center ",children:["Already have an account?"," ",e.jsxs(F,{to:`/login${i?`?redirects=${encodeURIComponent(i)}`:""}`,className:"pl-2 text-[#FFD700]  outline-none hover:underline focus:underline",children:["Login"," "]})," "]})]})})}export{z as default};
